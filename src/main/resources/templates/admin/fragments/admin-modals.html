<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>

	<div th:fragment="all-admin-modals">

		<div class="modal fade" id="addAdminModal" tabindex="-1"
			aria-labelledby="addAdminModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<form th:action="@{/admin/admins/add}" method="post"
						th:object="${adminAccountCreateDto}" id="addAdminForm">
						<div class="modal-header">
							<h5 class="modal-title" id="addAdminModalLabel">Add New
								Admin Account</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal"
								aria-label="Close"></button>
						</div>
						<div class="modal-body">
							<div th:if="${#fields.hasErrors('adminAccountCreateDto.*')}"
								class="alert alert-danger small p-2" role="alert">Error
								adding admin. Please check the form below.</div>

							<div class="row">
								<div class="col-md-6 mb-3">
									<label for="adminFirstName" class="form-label">First
										Name</label> <input type="text" class="form-control"
										th:field="*{firstName}" id="adminFirstName"
										th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('firstName')}"
										th:errors="*{firstName}">FN Error</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="adminLastName" class="form-label">Last Name</label>
									<input type="text" class="form-control" th:field="*{lastName}"
										id="adminLastName" th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('lastName')}"
										th:errors="*{lastName}">LN Error</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-6 mb-3">
									<label for="adminUsername" class="form-label">Username</label>
									<input type="text" class="form-control" th:field="*{username}"
										id="adminUsername" th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('username')}"
										th:errors="*{username}">User Error</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="adminEmail" class="form-label">Email</label> <input
										type="email" class="form-control" th:field="*{email}"
										id="adminEmail" th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Email
										Error</div>
								</div>
							</div>

							<hr>
							<h5 class="mb-3">Access Rights</h5>

							<div class="mb-3">
								<label for="adminRoleName" class="form-label">Assign
									Role</label> <select class="form-select" th:field="*{roleName}"
									id="adminRoleName" th:errorclass="is-invalid">
									<option value="">-- Select a Role --</option>
									<option th:each="role : ${allAdminRoles}"
										th:if="${role.name != 'ROLE_OWNER'}" th:value="${role.name}"
										th:text="${role.name.replace('ROLE_', '')}">Role Name
									</option>
								</select>
								<div class="invalid-feedback"
									th:if="${#fields.hasErrors('roleName')}"
									th:errors="*{roleName}">Role Name Error</div>
								<div class="form-text">Select a role to apply a template,
									then add or remove individual permission overrides below.</div>
							</div>

							<div class="row">
								<div class="col-md-6">
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageCustomers}" id="addManageCustomers">
										<label class="form-check-label" for="addManageCustomers">Customer
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageAdmins}" id="addManageAdmins"> <label
											class="form-check-label" for="addManageAdmins">Admin
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageOrders}" id="addManageOrders"> <label
											class="form-check-label" for="addManageOrders">Order
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageProducts}" id="addManageProducts">
										<label class="form-check-label" for="addManageProducts">Product
											Management</label>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageInventory}" id="addManageInventory">
										<label class="form-check-label" for="addManageInventory">Inventory
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageTransactions}" id="addManageTransactions">
										<label class="form-check-label" for="addManageTransactions">Transaction
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageSite}" id="addManageSite"> <label
											class="form-check-label" for="addManageSite">Site
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageActivityLog}" id="addManageActivityLog">
										<label class="form-check-label" for="addManageActivityLog">View
											Activity Log</label>
									</div>
								</div>
							</div>

							<hr>
							<h5 class="mb-3">Security</h5>
							<div class="row">
								<div class="col-md-6 mb-3">
									<label for="adminPassword" class="form-label">Password</label>
									<input type="password" class="form-control"
										th:field="*{password}" id="adminPassword"
										th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('password')}"
										th:errors="*{password}">PW Error</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="adminConfirmPassword" class="form-label">Confirm
										Password</label> <input type="password" class="form-control"
										th:field="*{confirmPassword}" id="adminConfirmPassword"
										th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('confirmPassword')}"
										th:errors="*{confirmPassword}">Confirm PW Error</div>
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button type="submit" class="btn btn-custom">Add Admin</button>
							<button type="button" class="btn btn-custom-secondary"
								data-bs-dismiss="modal">Cancel</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<div class="modal fade" id="editAdminModal" tabindex="-1"
			aria-labelledby="editAdminModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<form th:action="@{/admin/admins/update}" method="post"
						th:object="${adminUpdateDto}" id="editAdminForm">
						<div class="modal-header">
							<h5 class="modal-title" id="editAdminModalLabel">Edit Admin
								Account</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal"
								aria-label="Close"></button>
						</div>
						<div class="modal-body">
							<div th:if="${#fields.hasErrors('adminUpdateDto.*')}"
								class="alert alert-danger small p-2" role="alert">Please
								correct the errors below.</div>

							<input type="hidden" th:field="*{id}" />

							<h5 class="mb-3">Personal Information</h5>
							<div class="row">
								<div class="col-md-6 mb-3">
									<label for="editAdminFirstName" class="form-label">First
										Name</label> <input type="text" class="form-control"
										th:field="*{firstName}" id="editAdminFirstName"
										th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('firstName')}"
										th:errors="*{firstName}">Error</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="editAdminLastName" class="form-label">Last
										Name</label> <input type="text" class="form-control"
										th:field="*{lastName}" id="editAdminLastName"
										th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('lastName')}"
										th:errors="*{lastName}">Error</div>
								</div>
							</div>
							<div class="row">
								<div class="col-md-6 mb-3">
									<label for="editAdminUsername" class="form-label">Username</label>
									<input type="text" class="form-control" th:field="*{username}"
										id="editAdminUsername" th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('username')}"
										th:errors="*{username}">Error</div>
								</div>
								<div class="col-md-6 mb-3">
									<label for="editAdminEmail" class="form-label">Email</label> <input
										type="email" class="form-control" th:field="*{email}"
										id="editAdminEmail" th:errorclass="is-invalid">
									<div class="invalid-feedback"
										th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Error</div>
								</div>
							</div>

							<hr>
							<h5 class="mb-3">Access Rights</h5>

							<div class="mb-3">
								<label for="editAdminRoleName" class="form-label">Role</label> <select
									class="form-select" th:field="*{roleName}"
									id="editAdminRoleName" th:errorclass="is-invalid"
									th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}"
									th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change roles' : 'Select a role'}">
									<option value="">-- Select a Role --</option>
									<option th:each="role : ${allAdminRoles}"
										th:if="${role.name != 'ROLE_OWNER'}" th:value="${role.name}"
										th:text="${role.name.replace('ROLE_', '')}">Role Name
									</option>
								</select>
								<div class="invalid-feedback"
									th:if="${#fields.hasErrors('roleName')}"
									th:errors="*{roleName}">Role Name Error</div>
								<div class="form-text">Select a role to apply a template,
									then add or remove individual permission overrides below.</div>
							</div>

							<div class="row">
								<div class="col-md-6">
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageCustomers}" id="editManageCustomers"
											th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}">
										<label class="form-check-label" for="editManageCustomers"
											th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change permissions' : ''}">Customer
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageAdmins}" id="editManageAdmins"
											th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}">
										<label class="form-check-label" for="editManageAdmins"
											th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change permissions' : ''}">Admin
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageOrders}" id="editManageOrders"
											th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}">
										<label class="form-check-label" for="editManageOrders"
											th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change permissions' : ''}">Order
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageProducts}" id="editManageProducts"
											th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}">
										<label class="form-check-label" for="editManageProducts"
											th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change permissions' : ''}">Product
											Management</label>
									</div>
								</div>
								<div class="col-md-6">
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageInventory}" id="editManageInventory"
											th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}">
										<label class="form-check-label" for="editManageInventory"
											th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change permissions' : ''}">Inventory
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageTransactions}" id="editManageTransactions"
											th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}">
										<label class="form-check-label" for="editManageTransactions"
											th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change permissions' : ''}">Transaction
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageSite}" id="editManageSite"
											th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}">
										<label class="form-check-label" for="editManageSite"
											th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change permissions' : ''}">Site
											Management</label>
									</div>
									<div class="form-check form-switch mb-2">
										<input class="form-check-input" type="checkbox" role="switch"
											th:field="*{manageActivityLog}" id="editManageActivityLog"
											th:disabled="!${#authorization.expression('hasRole(''OWNER'')')}">
										<label class="form-check-label" for="editManageActivityLog"
											th:title="${#authorization.expression('!hasRole(''OWNER'')') ? 'Only the Owner can change permissions' : ''}">View
											Activity Log</label>
									</div>
								</div>
							</div>

							<hr>
							<div class="alert alert-warning small">Password cannot be
								changed from this form.</div>
						</div>
						<div class="modal-footer">
							<button type="submit" class="btn btn-custom">Save
								Changes</button>
							<button type="button" class="btn btn-custom-secondary"
								data-bs-dismiss="modal">Cancel</button>
						</div>
					</form>
				</div>
			</div>
		</div>

		<div class="modal fade" id="viewAdminModal" tabindex="-1"
			aria-labelledby="viewAdminModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="viewAdminModalLabel">Admin
							Details</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<h5 id="viewAdminName" class="mb-3">Admin Name</h5>
						<p>
							<strong>Username:</strong> <span id="viewAdminUsername"></span>
						</p>
						<p>
							<strong>Email:</strong> <span id="viewAdminEmail"></span>
						</p>
						<p>
							<strong>Role:</strong> <span id="viewAdminRole"></span>
						</p>
						<p class="mb-1">
							<strong>Account Created:</strong> <span id="viewAdminCreatedAt"></span>
						</p>

						<hr>
						<h6 class="mb-3">Assigned Modules (Role + Overrides)</h6>
						<div class="row">
							<div class="col-md-6">
								<ul class="list-unstyled permission-list">
									<li id="viewPermCustomers"><i class="fa-solid fa-fw me-2"></i>
										Customer Management</li>
									<li id="viewPermAdmins"><i class="fa-solid fa-fw me-2"></i>
										Admin Management</li>
									<li id="viewPermOrders"><i class="fa-solid fa-fw me-2"></i>
										Order Management</li>
									<li id="viewPermProducts"><i class="fa-solid fa-fw me-2"></i>
										Product Mgt.</li>
								</ul>
							</div>
							<div class="col-md-6">
								<ul class="list-unstyled permission-list">
									<li id="viewPermInventory"><i class="fa-solid fa-fw me-2"></i>
										Inventory Management</li>
									<li id="viewPermTransactions"><i
										class="fa-solid fa-fw me-2"></i> Transaction History</li>
									<li id="viewPermSite"><i class="fa-solid fa-fw me-2"></i>
										Site Management</li>
									<li id="viewPermActivityLog"><i
										class="fa-solid fa-fw me-2"></i> Activity Log</li>
								</ul>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-custom-secondary"
							data-bs-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="editProfileModal" tabindex="-1"
			aria-labelledby="editProfileModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<form th:action="@{/admin/admins/profile/update}" method="post"
						th:object="${adminProfileDto}" id="editProfileForm">
						<div class="modal-header">
							<h5 class="modal-title" id="editProfileModalLabel">Edit My
								Profile</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal"
								aria-label="Close"></button>
						</div>
						<div class="modal-body">
							<div th:if="${#fields.hasErrors('adminProfileDto.*')}"
								class="alert alert-danger small p-2" role="alert">Please
								correct the errors below.</div>

							<input type="hidden" th:field="*{id}" />
							<h5 class="mb-3">Personal Information</h5>
							<div class="mb-3">
								<label for="profileFirstName" class="form-label">First
									Name</label> <input type="text" class="form-control"
									th:field="*{firstName}" id="profileFirstName"
									th:errorclass="is-invalid">
								<div class="invalid-feedback"
									th:if="${#fields.hasErrors('firstName')}"
									th:errors="*{firstName}">Error</div>
							</div>
							<div class="mb-3">
								<label for="profileLastName" class="form-label">Last
									Name</label> <input type="text" class="form-control"
									th:field="*{lastName}" id="profileLastName"
									th:errorclass="is-invalid">
								<div class="invalid-feedback"
									th:if="${#fields.hasErrors('lastName')}"
									th:errors="*{lastName}">Error</div>
							</div>
							<div class="mb-3">
								<label for="profileUsername" class="form-label">Username</label>
								<input type="text" class="form-control" th:field="*{username}"
									id="profileUsername" th:errorclass="is-invalid">
								<div class="invalid-feedback"
									th:if="${#fields.hasErrors('username')}"
									th:errors="*{username}">Error</div>
							</div>
							<div class="mb-3">
								<label for="profileEmail" class="form-label">Email</label> <input
									type="email" class="form-control" th:field="*{email}"
									id="profileEmail" th:errorclass="is-invalid">
								<div class="invalid-feedback"
									th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Error</div>
							</div>

							<div class="alert alert-warning small">To change your
								password or role, please contact the System Owner.</div>
						</div>
						<div class="modal-footer">
							<button type="submit" class="btn btn-custom">Save
								Changes</button>
							<button type="button" class="btn btn-custom-secondary"
								data-bs-dismiss="modal">Cancel</button>
						</div>
					</form>
				</div>
			</div>
		</div>

	</div>
</body>
</html>